"name","description","data_code","global_state_code","shared_components","shared_styles","router_mode","tailwind_enabled","cdn_dependencies","custom_imports","page_ids/name","page_ids/route_path","page_ids/page_title","page_ids/sequence","page_ids/data_code","page_ids/component_code","endpoint_ids/name","endpoint_ids/endpoint_path","endpoint_ids/method","endpoint_ids/handler_code"
"Odoo Flappy Bird","Flappy Bird clone with Odoo theming, sound effects, and user stat tracking","","{ gameState: 'menu', score: 0, highScore: 0, gamesPlayed: 0, totalPipesPassed: 0 }","function OdooLogo({size = 40}) {
  return (
    <svg width={size} height={size} viewBox=""0 0 100 100"">
      <circle cx=""50"" cy=""50"" r=""45"" fill=""#714B67""/>
      <circle cx=""35"" cy=""45"" r=""8"" fill=""white""/>
      <circle cx=""65"" cy=""45"" r=""8"" fill=""white""/>
      <ellipse cx=""50"" cy=""65"" rx=""15"" ry=""8"" fill=""white""/>
    </svg>
  );
}

function createSoundManager() {
  let audioCtx = null;
  
  const getContext = () => {
    if (!audioCtx) {
      audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    }
    if (audioCtx.state === 'suspended') {
      audioCtx.resume();
    }
    return audioCtx;
  };
  
  const playFlap = () => {
    try {
      const ctx = getContext();
      const osc = ctx.createOscillator();
      const gain = ctx.createGain();
      osc.connect(gain);
      gain.connect(ctx.destination);
      osc.frequency.setValueAtTime(400, ctx.currentTime);
      osc.frequency.exponentialRampToValueAtTime(600, ctx.currentTime + 0.1);
      gain.gain.setValueAtTime(0.3, ctx.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.1);
      osc.start(ctx.currentTime);
      osc.stop(ctx.currentTime + 0.1);
    } catch(e) {}
  };
  
  const playScore = () => {
    try {
      const ctx = getContext();
      const osc = ctx.createOscillator();
      const gain = ctx.createGain();
      osc.connect(gain);
      gain.connect(ctx.destination);
      osc.frequency.setValueAtTime(523, ctx.currentTime);
      osc.frequency.setValueAtTime(659, ctx.currentTime + 0.1);
      osc.frequency.setValueAtTime(784, ctx.currentTime + 0.2);
      gain.gain.setValueAtTime(0.3, ctx.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.3);
      osc.start(ctx.currentTime);
      osc.stop(ctx.currentTime + 0.3);
    } catch(e) {}
  };
  
  const playGameOver = () => {
    try {
      const ctx = getContext();
      const osc = ctx.createOscillator();
      const gain = ctx.createGain();
      osc.connect(gain);
      gain.connect(ctx.destination);
      osc.type = 'sawtooth';
      osc.frequency.setValueAtTime(300, ctx.currentTime);
      osc.frequency.exponentialRampToValueAtTime(100, ctx.currentTime + 0.5);
      gain.gain.setValueAtTime(0.3, ctx.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.5);
      osc.start(ctx.currentTime);
      osc.stop(ctx.currentTime + 0.5);
    } catch(e) {}
  };
  
  return { playFlap, playScore, playGameOver };
}","@keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
.floating { animation: float 2s ease-in-out infinite; }
@keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
.pulsing { animation: pulse 1s ease-in-out infinite; }","Hash Router","True","","","Game","/","Odoo Flappy Bird","10","","function GamePage({storage, user}) {
  const canvasRef = useRef(null);
  const gameRef = useRef(null);
  const soundRef = useRef(null);
  const animFrameRef = useRef(null);
  const [gameState, setGameState] = useState('menu');
  const [score, setScore] = useState(0);
  const [stats, setStats] = useState({ highScore: 0, gamesPlayed: 0, totalPipesPassed: 0 });
  
  useEffect(() => {
    const loadStats = async () => {
      const saved = await storage.get('flappyStats', { highScore: 0, gamesPlayed: 0, totalPipesPassed: 0 });
      setStats(saved);
    };
    loadStats();
    soundRef.current = createSoundManager();
    return () => {
      if (animFrameRef.current) cancelAnimationFrame(animFrameRef.current);
    };
  }, []);
  
  const saveStats = async (newStats) => {
    setStats(newStats);
    await storage.set('flappyStats', newStats);
  };
  
  const GAME_WIDTH = 400;
  const GAME_HEIGHT = 600;
  const BIRD_SIZE = 35;
  const PIPE_WIDTH = 60;
  const PIPE_GAP = 150;
  const GRAVITY = 0.5;
  const JUMP_FORCE = -9;
  const PIPE_SPEED = 3;
  
  const initGame = () => {
    gameRef.current = {
      bird: { x: 80, y: GAME_HEIGHT / 2, velocity: 0, rotation: 0 },
      pipes: [],
      frameCount: 0,
      score: 0,
      isRunning: true
    };
  };
  
  const drawBird = (ctx, bird) => {
    ctx.save();
    ctx.translate(bird.x, bird.y);
    ctx.rotate(Math.min(bird.rotation, Math.PI / 4));
    ctx.fillStyle = '#714B67';
    ctx.beginPath();
    ctx.ellipse(0, 0, BIRD_SIZE / 2, BIRD_SIZE / 2.5, 0, 0, Math.PI * 2);
    ctx.fill();
    ctx.fillStyle = '#875A7B';
    ctx.beginPath();
    ctx.ellipse(-5, 5, 12, 8, -0.3, 0, Math.PI * 2);
    ctx.fill();
    ctx.fillStyle = 'white';
    ctx.beginPath();
    ctx.arc(8, -5, 8, 0, Math.PI * 2);
    ctx.fill();
    ctx.fillStyle = '#333';
    ctx.beginPath();
    ctx.arc(10, -5, 4, 0, Math.PI * 2);
    ctx.fill();
    ctx.fillStyle = '#F39C12';
    ctx.beginPath();
    ctx.moveTo(15, 0);
    ctx.lineTo(25, 3);
    ctx.lineTo(15, 8);
    ctx.closePath();
    ctx.fill();
    ctx.restore();
  };
  
  const drawPipe = (ctx, pipe) => {
    const gradient = ctx.createLinearGradient(pipe.x, 0, pipe.x + PIPE_WIDTH, 0);
    gradient.addColorStop(0, '#714B67');
    gradient.addColorStop(0.5, '#875A7B');
    gradient.addColorStop(1, '#714B67');
    ctx.fillStyle = gradient;
    ctx.fillRect(pipe.x, 0, PIPE_WIDTH, pipe.topHeight);
    ctx.fillStyle = '#5D3D54';
    ctx.fillRect(pipe.x - 5, pipe.topHeight - 25, PIPE_WIDTH + 10, 25);
    ctx.fillStyle = gradient;
    ctx.fillRect(pipe.x, pipe.topHeight + PIPE_GAP, PIPE_WIDTH, GAME_HEIGHT);
    ctx.fillStyle = '#5D3D54';
    ctx.fillRect(pipe.x - 5, pipe.topHeight + PIPE_GAP, PIPE_WIDTH + 10, 25);
  };
  
  const drawBackground = (ctx, frameCount) => {
    const skyGrad = ctx.createLinearGradient(0, 0, 0, GAME_HEIGHT);
    skyGrad.addColorStop(0, '#E8DFE5');
    skyGrad.addColorStop(1, '#F5F0F3');
    ctx.fillStyle = skyGrad;
    ctx.fillRect(0, 0, GAME_WIDTH, GAME_HEIGHT);
    ctx.fillStyle = 'rgba(255,255,255,0.8)';
    for (let i = 0; i < 3; i++) {
      const x = ((frameCount * 0.5 + i * 150) % (GAME_WIDTH + 100)) - 50;
      const y = 50 + i * 80;
      ctx.beginPath();
      ctx.arc(x, y, 30, 0, Math.PI * 2);
      ctx.arc(x + 25, y - 10, 25, 0, Math.PI * 2);
      ctx.arc(x + 50, y, 30, 0, Math.PI * 2);
      ctx.fill();
    }
    ctx.fillStyle = '#714B67';
    ctx.fillRect(0, GAME_HEIGHT - 50, GAME_WIDTH, 50);
    ctx.fillStyle = '#875A7B';
    for (let i = 0; i < GAME_WIDTH; i += 40) {
      ctx.fillRect(((i - frameCount * 2) % GAME_WIDTH + GAME_WIDTH) % GAME_WIDTH, GAME_HEIGHT - 50, 20, 10);
    }
  };
  
  const endGame = async (finalScore) => {
    if (gameRef.current) gameRef.current.isRunning = false;
    soundRef.current?.playGameOver();
    const newStats = {
      highScore: Math.max(stats.highScore, finalScore),
      gamesPlayed: stats.gamesPlayed + 1,
      totalPipesPassed: stats.totalPipesPassed + finalScore
    };
    await saveStats(newStats);
    setGameState('gameover');
  };
  
  const gameLoop = () => {
    if (!gameRef.current || !gameRef.current.isRunning) return;
    const ctx = canvasRef.current?.getContext('2d');
    if (!ctx) return;
    const game = gameRef.current;
    game.frameCount++;
    game.bird.velocity += GRAVITY;
    game.bird.y += game.bird.velocity;
    game.bird.rotation = game.bird.velocity * 0.05;
    if (game.frameCount % 100 === 0) {
      const topHeight = Math.random() * (GAME_HEIGHT - PIPE_GAP - 150) + 75;
      game.pipes.push({ x: GAME_WIDTH, topHeight, scored: false });
    }
    game.pipes = game.pipes.filter(pipe => {
      pipe.x -= PIPE_SPEED;
      if (!pipe.scored && pipe.x + PIPE_WIDTH < game.bird.x) {
        pipe.scored = true;
        game.score++;
        setScore(game.score);
        soundRef.current?.playScore();
      }
      return pipe.x > -PIPE_WIDTH;
    });
    const birdBox = {
      left: game.bird.x - BIRD_SIZE / 2 + 5,
      right: game.bird.x + BIRD_SIZE / 2 - 5,
      top: game.bird.y - BIRD_SIZE / 2.5 + 5,
      bottom: game.bird.y + BIRD_SIZE / 2.5 - 5
    };
    if (birdBox.bottom > GAME_HEIGHT - 50 || birdBox.top < 0) {
      endGame(game.score);
      return;
    }
    for (const pipe of game.pipes) {
      if (birdBox.right > pipe.x && birdBox.left < pipe.x + PIPE_WIDTH) {
        if (birdBox.top < pipe.topHeight || birdBox.bottom > pipe.topHeight + PIPE_GAP) {
          endGame(game.score);
          return;
        }
      }
    }
    drawBackground(ctx, game.frameCount);
    game.pipes.forEach(pipe => drawPipe(ctx, pipe));
    drawBird(ctx, game.bird);
    ctx.fillStyle = '#714B67';
    ctx.font = 'bold 48px Arial';
    ctx.textAlign = 'center';
    ctx.fillText(game.score, GAME_WIDTH / 2, 80);
    animFrameRef.current = requestAnimationFrame(gameLoop);
  };
  
  const startGame = () => {
    initGame();
    setScore(0);
    setGameState('playing');
    animFrameRef.current = requestAnimationFrame(gameLoop);
  };
  
  const jump = useCallback(() => {
    if (gameRef.current && gameRef.current.isRunning) {
      gameRef.current.bird.velocity = JUMP_FORCE;
      soundRef.current?.playFlap();
    }
  }, []);
  
  useEffect(() => {
    const handleKey = (e) => {
      if (e.code === 'Space' || e.code === 'ArrowUp') {
        e.preventDefault();
        if (gameState === 'menu' || gameState === 'gameover') {
          startGame();
        } else if (gameState === 'playing') {
          jump();
        }
      }
    };
    window.addEventListener('keydown', handleKey);
    return () => window.removeEventListener('keydown', handleKey);
  }, [gameState, jump]);
  
  const handleCanvasClick = () => {
    if (gameState === 'playing') {
      jump();
    }
  };
  
  return (
    <div className=""min-h-screen bg-gradient-to-b from-purple-100 to-purple-200 flex flex-col items-center justify-center p-4"">
      <div className=""text-center mb-4"">
        <h1 className=""text-4xl font-bold text-purple-900 flex items-center justify-center gap-3"">
          <OdooLogo size={50} /> Flappy Odoo
        </h1>
        {user && !user.is_public && <p className=""text-purple-700"">Playing as: {user.name}</p>}
      </div>
      <div className=""relative"">
        <canvas
          ref={canvasRef}
          width={GAME_WIDTH}
          height={GAME_HEIGHT}
          onClick={handleCanvasClick}
          className=""rounded-lg shadow-2xl cursor-pointer border-4 border-purple-900""
        />
        {gameState === 'menu' && (
          <div className=""absolute inset-0 flex flex-col items-center justify-center bg-black/50 rounded-lg"">
            <div className=""floating mb-8""><OdooLogo size={100} /></div>
            <h2 className=""text-white text-3xl font-bold mb-4"">Flappy Odoo</h2>
            <p className=""text-white/80 mb-6"">Click or press Space to fly!</p>
            <button onClick={startGame} className=""bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 px-8 rounded-full text-xl transition-all hover:scale-105"">Play</button>
            {stats.gamesPlayed > 0 && (
              <div className=""mt-6 text-white/90 text-center"">
                <p>High Score: {stats.highScore}</p>
                <p>Games Played: {stats.gamesPlayed}</p>
              </div>
            )}
          </div>
        )}
        {gameState === 'gameover' && (
          <div className=""absolute inset-0 flex flex-col items-center justify-center bg-black/60 rounded-lg"">
            <h2 className=""text-red-400 text-4xl font-bold mb-2"">Game Over!</h2>
            <p className=""text-white text-6xl font-bold mb-4"">{score}</p>
            {score >= stats.highScore && score > 0 && (
              <p className=""text-yellow-400 text-xl mb-4 pulsing"">New High Score!</p>
            )}
            <div className=""bg-white/20 rounded-lg p-4 mb-6 text-white"">
              <p>Best: {stats.highScore}</p>
              <p>Games: {stats.gamesPlayed}</p>
              <p>Total Pipes: {stats.totalPipesPassed}</p>
              <p>Avg Score: {stats.gamesPlayed > 0 ? (stats.totalPipesPassed / stats.gamesPlayed).toFixed(1) : 0}</p>
            </div>
            <button onClick={startGame} className=""bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 px-8 rounded-full text-xl transition-all hover:scale-105"">Play Again</button>
          </div>
        )}
      </div>
      <div className=""mt-4 text-purple-800 text-sm"">
        <p>Press <kbd className=""bg-purple-300 px-2 py-1 rounded"">Space</kbd> or <kbd className=""bg-purple-300 px-2 py-1 rounded"">Click</kbd> to flap</p>
      </div>
    </div>
  );
}","","","",""
